<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8"/>
<script type="text/javascript">
var kekka = "";
function clearText(){
  form.text.value = "";
  kekka = "";
}
function btnPressed(x){
  if( kekka!="" ){
     form.text.value = kekka;
      kekka = ""; }
  form.text.value += x;
}
function backSpace(){
  kekka = "";
  form.text.value = form.text.value.substring(0, form.text.value.length - 1);
}
function calculate(){
  if( kekka!="" ) return;
  kekka = eval(form.text.value);
  let historyDiv = document.getElementById("history");
    historyDiv.innerHTML += form.text.value +"="+kekka+"<br>"
  form.text.value = kekka;

  
}
function sqrt(){
  if( kekka!="" ){
    kekka = Math.sqrt(kekka);
  }else{
    kekka = Math.sqrt(eval(form.text.value));
  }
  let historyDiv = document.getElementById("history");
  historyDiv.innerHTML +=  "√"+form.text.value +"="+kekka+"<br>"
  form.text.value = kekka;
}

function sin(kekka){
  let radians = kekka*Math.PI/180;
  let result = Math.sin(radians);
  if(Math.abs(result) < 1e-15){
    result = 0;
  }
  return result;
}
function tan(kekka){
  if(kekka % 180 ==90){
    return "ERROR";
  }
  let radians = kekka*Math.PI/180;
  let result = Math.tan(radians);
  if(Math.abs(result) < 1e-15){
    result = 0;
  }
  return result;
}
function cos(kekka){
  let radians = kekka*Math.PI/180;
  let result = Math.cos(radians);
  if(Math.abs(result) < 1e-15){
    result = 0;
  }
  return result;
}
function factorial() {
  let factor =1;
  for(let i=1; i<= kekka; i++){
    factor *= i;
  }
  return factor;
}
function log(kekka){
  return Math.log10(kekka);
  

}
function clearHistory() {
  document.getElementById("historyContent").innerHTML = "";
}

 </script>
</head>
<body bgcolor="white">
<form name="form"> 
    <h1 style="text-align: center;">JavaScript電卓</h1>
    
    <div style="text-align: center; margin-bottom: 4px; ">
      <input type="text" name="text" size="50" style="width:330px; height:50px; font-size:30px; background-color: rgb(249, 235, 245); border-radius: 10px">
  </div>
  
    <table align="center"style="border-radius : 10px;  background-color: plum;">
    
   
    <td><input type ="button" value="BS" onClick="backSpace()" style="width:50px; height:50px; font-size:30px ; background-color: white; border-radius: 10px;" ></td>
    <td><input type ="button" value="!" onClick="btnPressed('factorial(')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    <td><input type ="button" value="(" onClick="btnPressed('(')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    <td><input type ="button" value=")" onClick="btnPressed(')')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    <td><input type ="button" value="√" onClick="sqrt()" style="width:50px; height:50px; font-size:30px ; background-color: white; border-radius: 10px;"></td>
    <td rowspan="2"><input type ="button" value="C" onClick="clearText()" style="width:50px; height:104px;; font-size:30px; background-color: white; border-radius: 10px;">
    </td>
</tr>
    <tr>
       <td><input type ="button" value="sin" onClick="btnPressed('sin(')" style="width:50px; height:50px; font-size:25px; background-color: white; border-radius: 10px;"></td>
        <td><input type ="button" value="7" onClick="btnPressed('7')" style="width:50px; height:50px; font-size:30px; background-color: rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="8" onClick="btnPressed('8')" style="width:50px; height:50px; font-size:30px; background-color:rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="9" onClick="btnPressed('9')" style="width:50px; height:50px; font-size:30px; background-color: rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="/" onClick="btnPressed('/')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    </tr>
    <tr>
    
    <td><input type ="button" value="cos" onClick="btnPressed('cos(')" style="width:50px; height:50px; font-size:25px; background-color: white; border-radius: 10px;"></td>
    <td><input type ="button" value="4" onClick="btnPressed('4')" style="width:50px; height:50px;font-size:30px; background-color: rgb(235, 138, 222); border-radius: 10px;"></td>
    <td><input type ="button" value="5" onClick="btnPressed('5')" style="width:50px; height:50px; font-size:30px; background-color:rgb(235, 138, 222); border-radius: 10px;"></td>
    <td><input type ="button" value="6" onClick="btnPressed('6')" style="width:50px; height:50px; font-size:30px; background-color: rgb(235, 138, 222); border-radius: 10px;"></td>
    <td><input type ="button" value="*" onClick="btnPressed('*')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    <td rowspan="3"><input type ="button" value="=" onClick="calculate()" style="width:50px; height:156px; font-size:30px; background-color: white; border-radius: 10px;">
    </td>
    </tr>

  
    <tr>

      <td><input type ="button" value="tan" onClick="btnPressed('tan(')" style="width:50px; height:50px; font-size:25px; background-color: white; border-radius: 10px;"></td>
        <td><input type ="button" value="1" onClick="btnPressed('1')" style="width:50px; height:50px; font-size:30px; background-color:rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="2" onClick="btnPressed('2')" style="width:50px; height:50px; font-size:30px; background-color:rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="3" onClick="btnPressed('3')" style="width:50px; height:50px; font-size:30px; background-color: rgb(235, 138, 222); border-radius: 10px;"></td>
        <td><input type ="button" value="-" onClick="btnPressed('-')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
        </tr>
    
    <tr>
      <td><input type ="button" value="log" onClick="btnPressed('log(')" style="width:50px; height:50px; font-size:25px; background-color: white; border-radius: 10px;"></td>
    <td colspan="2"><input type ="button" value="0" onClick="btnPressed('0')" style="width:104px; height:50px; font-size:30px; background-color:rgb(235, 138, 222); border-radius: 10px;"></td>
    <td><input type ="button" value="." onClick="btnPressed('.')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    <td><input type ="button" value="+" onClick="btnPressed('+')" style="width:50px; height:50px; font-size:30px; background-color: white; border-radius: 10px;"></td>
    </tr>
</table>
<div id="history" style = "width:330px; height:250px; margin: 20px auto; font-size: 15px; background-color: #f3daef; padding: 10px; border-radius: 10px; text-align: center"
<strong >履歴</strong>
<div id="historyContent" style="margin-top: 10px;"></div>
<button onclick="clearHistory()" style="position: absolute; bottom: 30px; left: 660px; font-size: 12px;">履歴クリア</button><br>


</div>

</form>
</body>
</html>